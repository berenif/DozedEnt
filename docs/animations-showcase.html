<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Animations Showcase - Dozed Ent</title>
    <link href="images/favicon.png" rel="icon" type="image/png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Space Mono', monospace;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #00ff88;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .header p {
            font-size: 1.2em;
            color: #aaa;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .demo-section {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            backdrop-filter: blur(5px);
        }
        
        .demo-canvas {
            width: 100%;
            max-width: 1000px;
            height: 600px;
            margin: 0 auto;
            display: block;
            border: 2px solid #00ff88;
            border-radius: 10px;
            background: #0a0e1a;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .control-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }
        
        .control-card h3 {
            color: #00ff88;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .control-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .control-item:last-child {
            border-bottom: none;
        }
        
        .key {
            background: #00ff88;
            color: #0a0e1a;
            padding: 4px 10px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .animation-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .animation-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 255, 136, 0.05));
            border: 2px solid #00ff88;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .animation-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }
        
        .animation-card h4 {
            color: #00ff88;
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        .animation-card p {
            color: #aaa;
            font-size: 0.9em;
            margin-bottom: 15px;
        }
        
        .animation-stats {
            display: flex;
            justify-content: space-around;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            display: block;
            font-size: 1.2em;
            color: #00ff88;
            font-weight: bold;
        }
        
        .stat-label {
            display: block;
            font-size: 0.8em;
            color: #666;
            margin-top: 2px;
        }
        
        .demo-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .demo-btn {
            background: #00ff88;
            color: #0a0e1a;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Space Mono', monospace;
        }
        
        .demo-btn:hover {
            background: #00cc70;
            transform: scale(1.05);
        }
        
        .demo-btn:active {
            transform: scale(0.95);
        }
        
        .status-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ff88;
            border-radius: 10px;
            padding: 15px;
            min-width: 200px;
            z-index: 1000;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .status-label {
            color: #00ff88;
        }
        
        .status-value {
            color: white;
            font-weight: bold;
        }
        
        .documentation-links {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            text-align: center;
        }
        
        .doc-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .doc-link {
            color: #00ff88;
            text-decoration: none;
            padding: 10px 20px;
            border: 1px solid #00ff88;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .doc-link:hover {
            background: #00ff88;
            color: #0a0e1a;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .demo-canvas {
                height: 400px;
            }
            
            .status-panel {
                position: static;
                margin: 20px auto;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéÆ Player Animation System</h1>
        <p>Advanced character animations with smooth transitions and effects</p>
    </div>
    
    <div class="main-container">
        <!-- Live Demo Section -->
        <div class="demo-section">
            <canvas id="gameCanvas" class="demo-canvas" width="1000" height="600"></canvas>
            
            <div class="demo-buttons">
                <button class="demo-btn" onclick="spawnEnemy()">üëæ Spawn Enemy</button>
                <button class="demo-btn" onclick="clearEnemies()">üóëÔ∏è Clear Enemies</button>
                <button class="demo-btn" onclick="restoreHealth()">‚ù§Ô∏è Full Health</button>
                <button class="demo-btn" onclick="restoreStamina()">‚ö° Full Stamina</button>
                <button class="demo-btn" onclick="toggleGodMode()">üõ°Ô∏è God Mode</button>
                <button class="demo-btn" onclick="respawnPlayer()">üîÑ Respawn</button>
            </div>
        </div>
        
        <!-- Controls Section -->
        <div class="demo-section">
            <h2 style="text-align: center; margin-bottom: 20px; color: #00ff88;">üéÆ Controls</h2>
            <div class="controls-grid">
                <div class="control-card">
                    <h3>Movement</h3>
                    <div class="control-item">
                        <span>Move Up</span>
                        <span><span class="key">W</span> / <span class="key">‚Üë</span></span>
                    </div>
                    <div class="control-item">
                        <span>Move Down</span>
                        <span><span class="key">S</span> / <span class="key">‚Üì</span></span>
                    </div>
                    <div class="control-item">
                        <span>Move Left</span>
                        <span><span class="key">A</span> / <span class="key">‚Üê</span></span>
                    </div>
                    <div class="control-item">
                        <span>Move Right</span>
                        <span><span class="key">D</span> / <span class="key">‚Üí</span></span>
                    </div>
                </div>
                
                <div class="control-card">
                    <h3>Combat</h3>
                    <div class="control-item">
                        <span>Attack</span>
                        <span><span class="key">Space</span> / <span class="key">J</span></span>
                    </div>
                    <div class="control-item">
                        <span>Block</span>
                        <span><span class="key">Shift</span> / <span class="key">K</span></span>
                    </div>
                    <div class="control-item">
                        <span>Roll/Dodge</span>
                        <span><span class="key">Ctrl</span> / <span class="key">L</span></span>
                    </div>
                    <div class="control-item">
                        <span>Test Damage</span>
                        <span><span class="key">H</span></span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Animation Cards -->
        <div class="demo-section">
            <h2 style="text-align: center; margin-bottom: 20px; color: #00ff88;">‚ú® Animation States</h2>
            <div class="animation-cards">
                <div class="animation-card" onclick="triggerAnimation('idle')">
                    <h4>üßç Idle</h4>
                    <p>Default resting state with subtle breathing animation</p>
                    <div class="animation-stats">
                        <div class="stat">
                            <span class="stat-value">4</span>
                            <span class="stat-label">Frames</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">Loop</span>
                            <span class="stat-label">Type</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-card" onclick="triggerAnimation('run')">
                    <h4>üèÉ Running</h4>
                    <p>Dynamic movement animation with speed variations</p>
                    <div class="animation-stats">
                        <div class="stat">
                            <span class="stat-value">6</span>
                            <span class="stat-label">Frames</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">Loop</span>
                            <span class="stat-label">Type</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-card" onclick="triggerAnimation('attack')">
                    <h4>‚öîÔ∏è Attack</h4>
                    <p>Powerful melee strike with damage dealing</p>
                    <div class="animation-stats">
                        <div class="stat">
                            <span class="stat-value">0.4s</span>
                            <span class="stat-label">Duration</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">20</span>
                            <span class="stat-label">Damage</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-card" onclick="triggerAnimation('block')">
                    <h4>üõ°Ô∏è Block</h4>
                    <p>Defensive stance reducing incoming damage</p>
                    <div class="animation-stats">
                        <div class="stat">
                            <span class="stat-value">50%</span>
                            <span class="stat-label">Reduction</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">Hold</span>
                            <span class="stat-label">Type</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-card" onclick="triggerAnimation('roll')">
                    <h4>üåÄ Roll</h4>
                    <p>Evasive dodge with invulnerability frames</p>
                    <div class="animation-stats">
                        <div class="stat">
                            <span class="stat-value">0.4s</span>
                            <span class="stat-label">Duration</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">25</span>
                            <span class="stat-label">Stamina</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-card" onclick="triggerAnimation('hurt')">
                    <h4>üíî Hurt</h4>
                    <p>Damage reaction with knockback effect</p>
                    <div class="animation-stats">
                        <div class="stat">
                            <span class="stat-value">0.3s</span>
                            <span class="stat-label">Duration</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">Auto</span>
                            <span class="stat-label">Trigger</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Documentation Links -->
        <div class="documentation-links">
            <h3 style="color: #00ff88; margin-bottom: 10px;">üìö Documentation</h3>
            <div class="doc-links">
                <a href="PLAYER_ANIMATIONS.md" class="doc-link">Player Animations Guide</a>
                <a href="ANIMATION_SYSTEM_INDEX.md" class="doc-link">Animation System Docs</a>
                <a href="../demo/player-animations-demo.html" class="doc-link">Full Demo</a>
                <a href="https://github.com/dmotz/trystero" class="doc-link">GitHub</a>
            </div>
        </div>
    </div>
    
    <!-- Status Panel -->
    <div class="status-panel">
        <h3 style="color: #00ff88; margin-bottom: 10px; text-align: center;">Status</h3>
        <div class="status-item">
            <span class="status-label">Health:</span>
            <span class="status-value" id="health">100/100</span>
        </div>
        <div class="status-item">
            <span class="status-label">Stamina:</span>
            <span class="status-value" id="stamina">100/100</span>
        </div>
        <div class="status-item">
            <span class="status-label">State:</span>
            <span class="status-value" id="state">idle</span>
        </div>
        <div class="status-item">
            <span class="status-label">Animation:</span>
            <span class="status-value" id="animation">idle</span>
        </div>
        <div class="status-item">
            <span class="status-label">Enemies:</span>
            <span class="status-value" id="enemyCount">0</span>
        </div>
    </div>
    
    <script type="module">
        // Import the built player animator
        import AnimatedPlayer from './dist/player-animator.js'
        
        const canvas = document.getElementById('gameCanvas')
        const ctx = canvas.getContext('2d')
        
        // Game state
        let player = null
        let enemies = []
        let particles = []
        let godMode = false
        
        // Simple particle system
        class SimpleParticleSystem {
            constructor() {
                this.particles = []
            }
            
            createDustCloud(x, y) {
                for (let i = 0; i < 10; i++) {
                    this.particles.push({
                        x: x + (Math.random() - 0.5) * 20,
                        y: y + (Math.random() - 0.5) * 20,
                        vx: (Math.random() - 0.5) * 100,
                        vy: (Math.random() - 0.5) * 100,
                        life: 0.5,
                        maxLife: 0.5,
                        color: 'rgba(255, 255, 255, 0.5)',
                        size: Math.random() * 3 + 2
                    })
                }
            }
            
            createSlashEffect(x, y, facing) {
                for (let i = 0; i < 5; i++) {
                    this.particles.push({
                        x: x,
                        y: y + (Math.random() - 0.5) * 20,
                        vx: facing * 200 + (Math.random() - 0.5) * 50,
                        vy: (Math.random() - 0.5) * 50,
                        life: 0.3,
                        maxLife: 0.3,
                        color: 'rgba(255, 255, 0, 0.8)',
                        size: Math.random() * 2 + 1
                    })
                }
            }
            
            createBloodEffect(x, y) {
                for (let i = 0; i < 8; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 150,
                        vy: (Math.random() - 0.5) * 150,
                        life: 0.4,
                        maxLife: 0.4,
                        color: 'rgba(255, 0, 0, 0.7)',
                        size: Math.random() * 3 + 1
                    })
                }
            }
            
            update(deltaTime) {
                this.particles = this.particles.filter(p => {
                    p.life -= deltaTime
                    p.x += p.vx * deltaTime
                    p.y += p.vy * deltaTime
                    p.vx *= 0.95
                    p.vy *= 0.95
                    return p.life > 0
                })
            }
            
            render(ctx) {
                this.particles.forEach(p => {
                    ctx.save()
                    ctx.globalAlpha = p.life / p.maxLife
                    ctx.fillStyle = p.color
                    ctx.beginPath()
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2)
                    ctx.fill()
                    ctx.restore()
                })
            }
        }
        
        const particleSystem = new SimpleParticleSystem()
        
        // Initialize player
        function initPlayer() {
            player = new AnimatedPlayer(500, 300, {
                particleSystem: particleSystem,
                color: '#00ff88'
            })
        }
        
        // Input handling
        const keys = {}
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true
            e.preventDefault()
        })
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false
            e.preventDefault()
        })
        
        // Global functions for buttons
        window.spawnEnemy = function() {
            enemies.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: 0,
                vy: 0,
                health: 50,
                maxHealth: 50,
                radius: 20,
                color: '#ff4444'
            })
        }
        
        window.clearEnemies = function() {
            enemies = []
        }
        
        window.restoreHealth = function() {
            if (player) player.health = player.maxHealth
        }
        
        window.restoreStamina = function() {
            if (player) player.stamina = player.maxStamina
        }
        
        window.toggleGodMode = function() {
            godMode = !godMode
            if (player) {
                player.invulnerable = godMode
                player.invulnerabilityTimer = godMode ? 999999 : 0
            }
        }
        
        window.respawnPlayer = function() {
            if (player) player.respawn(500, 300)
        }
        
        window.triggerAnimation = function(animName) {
            if (!player) return
            
            switch(animName) {
                case 'idle':
                    player.setState('idle')
                    break
                case 'run':
                    player.setState('running')
                    break
                case 'attack':
                    if (player.canAttack()) player.startAttack()
                    break
                case 'block':
                    if (player.canBlock()) player.startBlock()
                    setTimeout(() => player.stopBlock(), 1000)
                    break
                case 'roll':
                    if (player.canRoll()) player.startRoll({})
                    break
                case 'hurt':
                    player.takeDamage(10, 0.5, 0.5)
                    break
            }
        }
        
        // Update enemies
        function updateEnemies(deltaTime) {
            enemies.forEach(enemy => {
                const dx = player.x - enemy.x
                const dy = player.y - enemy.y
                const dist = Math.hypot(dx, dy)
                
                if (dist > 50 && dist < 300) {
                    enemy.vx += (dx / dist) * 200 * deltaTime
                    enemy.vy += (dy / dist) * 200 * deltaTime
                }
                
                enemy.vx *= Math.pow(0.5, deltaTime)
                enemy.vy *= Math.pow(0.5, deltaTime)
                
                enemy.x += enemy.vx * deltaTime
                enemy.y += enemy.vy * deltaTime
                
                enemy.x = Math.max(enemy.radius, Math.min(canvas.width - enemy.radius, enemy.x))
                enemy.y = Math.max(enemy.radius, Math.min(canvas.height - enemy.radius, enemy.y))
                
                if (player.state === 'attacking' && player.attackExecuted) {
                    const attackDist = Math.hypot(enemy.x - player.x, enemy.y - player.y)
                    if (attackDist < 80) {
                        enemy.health -= 20
                        const angle = Math.atan2(enemy.y - player.y, enemy.x - player.x)
                        enemy.vx = Math.cos(angle) * 300
                        enemy.vy = Math.sin(angle) * 300
                    }
                }
                
                if (dist < 40 && Math.random() < 0.01 && !godMode) {
                    const angle = Math.atan2(player.y - enemy.y, player.x - enemy.x)
                    player.takeDamage(10, Math.cos(angle), Math.sin(angle))
                }
            })
            
            enemies = enemies.filter(e => e.health > 0)
        }
        
        // Render enemies
        function renderEnemies(ctx) {
            enemies.forEach(enemy => {
                ctx.save()
                ctx.beginPath()
                ctx.arc(enemy.x, enemy.y, enemy.radius, 0, Math.PI * 2)
                ctx.fillStyle = enemy.color
                ctx.fill()
                ctx.strokeStyle = '#ff8888'
                ctx.lineWidth = 2
                ctx.stroke()
                
                const barWidth = 30
                const barHeight = 4
                const barY = enemy.y - enemy.radius - 10
                
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)'
                ctx.fillRect(enemy.x - barWidth/2, barY, barWidth, barHeight)
                
                const healthPercent = enemy.health / enemy.maxHealth
                ctx.fillStyle = healthPercent > 0.5 ? '#00ff00' : '#ff0000'
                ctx.fillRect(enemy.x - barWidth/2, barY, barWidth * healthPercent, barHeight)
                
                ctx.restore()
            })
        }
        
        // Update UI
        function updateUI() {
            document.getElementById('health').textContent = 
                player ? `${Math.floor(player.health)}/${player.maxHealth}` : '0/0'
            document.getElementById('stamina').textContent = 
                player ? `${Math.floor(player.stamina)}/${player.maxStamina}` : '0/0'
            document.getElementById('state').textContent = player?.state || 'none'
            document.getElementById('animation').textContent = 
                player?.animator?.controller?.currentAnimation?.name || 'none'
            document.getElementById('enemyCount').textContent = enemies.length
        }
        
        // Game loop
        let lastTime = 0
        function gameLoop(timestamp) {
            const deltaTime = Math.min((timestamp - lastTime) / 1000, 0.1)
            lastTime = timestamp
            
            if (player) {
                const input = AnimatedPlayer.createInputFromKeys(keys)
                
                if (keys['h']) {
                    keys['h'] = false
                    player.takeDamage(15, (Math.random() - 0.5) * 2, (Math.random() - 0.5) * 2)
                }
                
                player.update(deltaTime, input)
                player.x = Math.max(20, Math.min(canvas.width - 20, player.x))
                player.y = Math.max(20, Math.min(canvas.height - 20, player.y))
            }
            
            updateEnemies(deltaTime)
            particleSystem.update(deltaTime)
            
            // Clear canvas
            ctx.fillStyle = '#0a0e1a'
            ctx.fillRect(0, 0, canvas.width, canvas.height)
            
            // Draw grid
            ctx.strokeStyle = 'rgba(0, 255, 136, 0.05)'
            ctx.lineWidth = 1
            for (let x = 0; x < canvas.width; x += 50) {
                ctx.beginPath()
                ctx.moveTo(x, 0)
                ctx.lineTo(x, canvas.height)
                ctx.stroke()
            }
            for (let y = 0; y < canvas.height; y += 50) {
                ctx.beginPath()
                ctx.moveTo(0, y)
                ctx.lineTo(canvas.width, y)
                ctx.stroke()
            }
            
            // Render
            renderEnemies(ctx)
            particleSystem.render(ctx)
            if (player) player.render(ctx)
            
            updateUI()
            
            requestAnimationFrame(gameLoop)
        }
        
        // Initialize and start
        initPlayer()
        requestAnimationFrame(gameLoop)
        
        // Spawn initial enemies
        for (let i = 0; i < 3; i++) {
            spawnEnemy()
        }
    </script>
</body>
</html>